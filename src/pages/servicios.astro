---
import Layout from "../layouts/Layout.astro";
import { Icon } from "astro-icon/components";
import ScrollReveal from "@/components/ScrollReveal.astro";
import { Image, Picture, getImage } from "astro:assets";
import heroServicios from "@/assets/servicios/servicios-hero.webp";

// Importar im谩genes de servicios
import reconocimientoDron from "@/assets/servicios/dron-reconocimiento.webp";
import captacionImg from "@/assets/servicios/captacion.webp";
import polietilenoImg from "@/assets/servicios/polietileno.webp";


const captacion = await getImage({ src: captacionImg, format: "webp" });
const polietileno = await getImage({ src: polietilenoImg, format: "webp" });

// Definir servicios
const services = [
  {
    id: 1,
    number: "01",
    emoji: "",
    title: "Mapeo con dron",
    subtitle: "Mapeo con fin de zonificaci贸n territorial y estudio h铆drico",
    features: [
      "Levantamiento con dron georreferenciado",
      "Ortofotos y nube de puntos",
      "Modelo digital de terreno (MDT)",
      "Identificaci贸n de afloramientos y vasos h铆dricos",
      "Modelos 3D de microreservorios",
    ],
    price: "Desde S/. 420.00",
    image: {
      src: reconocimientoDron.src
    },
  },
  {
    id: 2,
    number: "02",
    emoji: "",
    title: "Captaci贸n de agua",
    subtitle: "Dise帽o e instalaci贸n de sistemas de captaci贸n",
    features: [
      "Captaci贸n con caja HDPE",
      "Captaci贸n con mamposter铆a",
      "Filtros, v谩lvulas y conducci贸n",
      "Dise帽o por gravedad",
    ],
    price: "Desde S/. 280.00",
    image: {
      src: captacion.src,
      width: captacion.attributes.width as number,
      height: captacion.attributes.height as number,
    },
  },
  {
    id: 3,
    number: "03",
    emoji: "",
    title: "Almacenamiento y distribuci贸n",
    subtitle: "Infraestructura h铆drica completa",
    features: [
      "Microreservorios",
      "Tanques de polietileno",
      "Redes de distribuci贸n para personas y ganado",
    ],
    price: "Bajo cotizaci贸n",
    image: {
      src: polietileno.src,
      width: polietileno.attributes.width as number,
      height: polietileno.attributes.height as number,
    },
  },
];
---

<Layout title="Servicios">
  <main class="w-full overflow-x-hidden">
    <!-- Hero Section -->

    <section
      class="relative flex min-h-[60vh] items-center justify-center overflow-hidden bg-cover bg-center"
    >
      <Picture
        src={heroServicios}
        class="w-full h-full object-cover object-center absolute inset-0 brightness-75"
        widths={[240, 540, 720, heroServicios.width]}
        sizes={`(max-width: 360px) 240px, (max-width: 720px) 540px, (max-width: 1600px) 720px, ${heroServicios.width}px`}
        alt="Una descripci贸n de mi imagen."
        quality="low"
        loading="lazy"
      />
      <!-- Overlay -->
      <div class="absolute inset-0 bg-black/30"></div>

      <div
        class="relative z-10 max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 text-center py-20"
      >
        <ScrollReveal
          delay={200}
          animation="fade-up"
          intensity="medium"
          client:visible
        >
          <h1
            class="text-5xl md:text-6xl lg:text-7xl font-bold text-white mb-6 leading-tight animate-slide-up"
          >
            Nuestros
            <span class="relative inline-block">
              <span class="text-[#02b6d4]">Servicios</span>
              <svg
                class="absolute -bottom-2 left-0 w-full"
                height="8"
                viewBox="0 0 200 8"
                fill="none"
              >
                <path
                  d="M1 5.5Q50 1 100 5.5T199 5.5"
                  stroke="url(#gradient)"
                  stroke-width="3"
                  stroke-linecap="round"
                  class="animate-draw"></path>
                <defs>
                  <linearGradient
                    id="gradient"
                    x1="0%"
                    y1="0%"
                    x2="100%"
                    y2="0%"
                  >
                    <stop offset="0%" stop-color="#06b6d4"></stop>
                    <stop offset="100%" stop-color="#2563eb"></stop>
                  </linearGradient>
                </defs>
              </svg>
            </span>
          </h1>
        </ScrollReveal>

        <p
          class="text-2xl md:text-2xl text-white max-w-3xl mx-auto leading-relaxed animate-slide-up-delay"
        >
          Soluciones t茅cnicas adaptadas al
          <span class="font-semibold text-white"> territorio altoandino </span>
        </p>
      </div>
    </section>
  </main>

  <!-- Servicios interactivos -->
  <section class="bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <!-- Header minimalista -->
      <ScrollReveal delay={100} animation="fade-up" intensity="medium" client:visible>
        <div class="py-12 sm:py-16 lg:py-32 border-b border-gray-100">
          <div class="max-w-3xl">
            <div class="mb-4 sm:mb-6 max-w-40">
              <p class="text-white font-medium mb-4 tracking-wide uppercase text-xs sm:text-sm bg-[#000000] p-2 rounded-2xl text-center w-full">
                Lo que hacemos
              </p>
            </div>

            <h2 class="text-2xl sm:text-3xl md:text-4xl lg:text-5xl xl:text-6xl font-bold text-[#02B6D4] leading-tight">
              Soluciones integrales para{" "}
              <span class="text-gray-400">el acceso al agua</span>
            </h2>
          </div>
        </div>
      </ScrollReveal>

      <!-- Lista de servicios -->
      <div>
        {services.map((service, index) => {
          const isReversed = index % 2 === 1;
          const isLast = index === services.length - 1;
          
          return (
            <article class="group">
              <ScrollReveal delay={150 * index} animation="fade-up" intensity="medium" client:visible>
                <div class={`grid grid-cols-1 lg:grid-cols-12 gap-6 sm:gap-8 lg:gap-16 items-center py-10 sm:py-12 lg:py-24`}>
                  <!-- N煤mero y contenido -->
                  <div class={`lg:col-span-5 ${isReversed ? "lg:order-2" : "lg:order-1"}`}>
                    <!-- N煤mero grande -->
                    <div class="mb-4 sm:mb-6">
                      <span class="text-5xl sm:text-6xl md:text-7xl lg:text-8xl xl:text-9xl font-black text-[#02B6D4] select-none leading-none">
                        {service.number}
                      </span>
                    </div>

                    <!-- Emoji y t铆tulo -->
                    <div>
                      <div class="flex items-center gap-2 sm:gap-3 mb-3 sm:mb-4">
                        <h3 class="text-xl sm:text-2xl md:text-3xl lg:text-4xl font-bold text-gray-400">
                          {service.title}
                        </h3>
                      </div>

                      <p class="text-base sm:text-lg text-gray-500 mb-6 sm:mb-8">
                        {service.subtitle}
                      </p>
                    </div>

                    <!-- Features como lista simple -->
                    <ul class="space-y-3 mb-8">
                      {service.features.map((feature, idx) => (
                        <li class="flex items-start gap-3 text-gray-600">
                          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 text-cyan-700 flex-shrink-0 mt-0.5">
                            <path d="m9 18 6-6-6-6"/>
                          </svg>
                          <span>{feature}</span>
                        </li>
                      ))}
                    </ul>

                    <!-- Precio y CTA -->
                    <div class="flex flex-col sm:flex-row items-start sm:items-center gap-6">
                      <div>
                        <p class="text-sm text-gray-400 mb-1">Inversi贸n</p>
                        <p class="text-2xl font-bold text-indigo-500">
                          {service.price}
                        </p>
                      </div>

                      <a
                        href="/contactanos"
                        class="inline-flex items-center gap-2 text-cyan-600 font-semibold hover:text-cyan-700 transition-colors group/link mt-6"
                      >
                        <span>Solicitar cotizaci贸n</span>
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 transition-transform group-hover/link:translate-x-1">
                          <path d="M5 12h14"/>
                          <path d="m12 5 7 7-7 7"/>
                        </svg>
                      </a>
                    </div>
                  </div>

                  <!-- Imagen -->
                  <div class={`lg:col-span-7 ${isReversed ? "lg:order-1" : "lg:order-2"}`}>
                    <div class="relative aspect-[4/3] lg:aspect-[16/10] overflow-hidden rounded-2xl bg-gray-100">
                      <img
                        src={service.image.src}
                        width={service.image.width}
                        height={service.image.height}
                        alt={service.title}
                        class="w-full h-full object-cover transition-transform duration-[600ms] ease-out group-hover:scale-[1.03]"
                        loading="lazy"
                        decoding="async"
                      />
                      <!-- Overlay sutil -->
                      <div class="absolute inset-0 bg-gradient-to-t from-black/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500" />
                    </div>
                  </div>
                </div>
              </ScrollReveal>

              {/* L铆nea divisoria */}
              {!isLast && (
                <div class="h-px bg-gradient-to-r from-transparent via-gray-200 to-transparent origin-left" />
              )}
            </article>
          );
        })}
      </div>
    </div>
  </section>

  <!-- CTA Final - Consulta de Servicios -->
  <section class="py-20 bg-slate-50 relative">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="bg-white rounded-3xl shadow-xl overflow-hidden">
        <!-- Lado derecho - Visual -->
        <div
          class="bg-gradient-to-br from-[#02b6d4] to-[#039bb2] p-4 sm:p-6 md:p-10 lg:p-14 justify-center text-white relative"
        >
          <div class="absolute inset-0 opacity-10">
            <svg
              class="w-full h-full"
              viewBox="0 0 100 100"
              preserveAspectRatio="none"
            >
              <defs>
                <pattern
                  id="grid"
                  width="10"
                  height="10"
                  patternUnits="userSpaceOnUse"
                >
                  <path
                    d="M 10 0 L 0 0 0 10"
                    fill="none"
                    stroke="white"
                    stroke-width="0.5"></path>
                </pattern>
              </defs>
              <rect width="100" height="100" fill="url(#grid)"></rect>
            </svg>
          </div>
          <div class="flex flex-col lg:flex-row justify-between gap-8 lg:gap-4">
            <ScrollReveal
              delay={200}
              animation="fade-left"
              intensity="medium"
              client:visible
            >
              <div class="relative z-10 p-4 sm:p-8 lg:p-12">
                <h3
                  class="text-3xl sm:text-4xl md:text-5xl lg:text-6xl xl:text-7xl font-bold mb-6 leading-tight"
                >
                  Si tienes alguna <span class="block"
                    >pregunta o <span class="block"
                      >consulta, <span class="block">ll谩manos</span></span
                    >
                  </span>
                </h3>
              </div>
            </ScrollReveal>

            <ScrollReveal
              delay={200}
              animation="fade-right"
              intensity="medium"
              client:visible
            >
              <div class="relative z-10 flex flex-col justify-center lg:mt-16">
                <div
                  class="font-bold text-xl sm:text-2xl md:text-3xl lg:text-4xl mb-8 lg:mb-16 flex flex-row px-4 sm:px-6 lg:px-8 py-3 justify-center items-center rounded-3xl bg-amber-600"
                >
                  <Icon
                    name="phone"
                    class="w-[40px] h-[40px] sm:w-[60px] sm:h-[60px] lg:w-[90px] lg:h-[90px]"
                  />
                  <p class="ml-2 sm:ml-4">+51 915030965</p>
                </div>
                <div
                  class="font-bold text-sm sm:text-lg md:text-xl lg:text-2xl flex flex-col gap-4 lg:gap-8"
                >
                  <div
                    class="flex flex-row bg-amber-600 px-4 sm:px-6 py-3 sm:py-4 rounded-2xl lg:rounded-3xl items-center"
                  >
                    <Icon
                      name="oficina"
                      class="w-[24px] h-[24px] sm:w-[30px] sm:h-[30px] lg:w-[36px] lg:h-[36px] flex-shrink-0"
                    />
                    <p class="ml-2 sm:ml-4">Jr. Los Pinos (almacen central)</p>
                  </div>
                  <div>
                    <div
                      class="flex flex-row bg-amber-600 px-4 sm:px-6 py-3 sm:py-4 rounded-2xl lg:rounded-3xl items-center"
                    >
                      <Icon
                        name="ubicacion"
                        class="w-[24px] h-[24px] sm:w-[30px] sm:h-[30px] lg:w-[36px] lg:h-[36px] flex-shrink-0"
                      />
                      <p class="ml-2 sm:ml-4">Macusani - Carabaya - Puno</p>
                    </div>
                  </div>
                </div>
              </div>
            </ScrollReveal>
          </div>
        </div>
      </div>

      <style>
        @keyframes draw {
          from {
            stroke-dashoffset: 200;
          }
          to {
            stroke-dashoffset: 0;
          }
        }

        .animate-slide-up {
          @apply animate-[slideUp_0.8s_ease-out_forwards];
        }

        .animate-slide-up-delay {
          @apply animate-[slideUp_0.8s_ease-out_0.2s_forwards] opacity-0;
        }

        .animate-draw {
          stroke-dasharray: 200;
          stroke-dashoffset: 200;
          animation: draw 1.5s ease-out 0.5s forwards;
        }

        @keyframes slideUp {
          from {
            opacity: 0;
            transform: translateY(30px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
      </style>
    </div>
  </section>
</Layout>
