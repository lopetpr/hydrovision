---
import Layout from "../layouts/Layout.astro";
import ServiciosSection from "@/components/ui/ServiciosSection";

import { Icon } from "astro-icon/components";

import ScrollReveal from "@/components/ScrollReveal.astro";
import { Image, Picture, getImage } from "astro:assets";
import heroServicios from "@/assets/servicios/servicios-hero.webp";

// Importar imágenes de servicios
import reconocimientoDronImg from "@/assets/servicios/reconocimiento-dron.jpg";
import captacionImg from "@/assets/servicios/captacion.webp";
import polietilenoImg from "@/assets/servicios/polietileno.webp";

// Obtener imágenes optimizadas con getImage()
const reconocimientoDron = await getImage({
  src: reconocimientoDronImg,
  format: "webp",
});
const captacion = await getImage({ src: captacionImg, format: "webp" });
const polietileno = await getImage({ src: polietilenoImg, format: "webp" });

const serviciosImages = {
  reconocimientoDron: {
    src: reconocimientoDron.src,
    width: reconocimientoDron.attributes.width as number,
    height: reconocimientoDron.attributes.height as number,
  },
  captacion: {
    src: captacion.src,
    width: captacion.attributes.width as number,
    height: captacion.attributes.height as number,
  },
  polietileno: {
    src: polietileno.src,
    width: polietileno.attributes.width as number,
    height: polietileno.attributes.height as number,
  },
};
---

<Layout title="Servicios">
  <main class="w-full overflow-x-hidden">
    <!-- Hero Section -->

    <section
      class="relative flex min-h-[60vh] items-center justify-center overflow-hidden bg-cover bg-center"
    >
      <Picture
        src={heroServicios}
        class="w-full h-full object-cover object-center absolute inset-0 brightness-75"
        widths={[240, 540, 720, heroServicios.width]}
        sizes={`(max-width: 360px) 240px, (max-width: 720px) 540px, (max-width: 1600px) 720px, ${heroServicios.width}px`}
        alt="Una descripción de mi imagen."
        quality="low"
        loading="lazy"
      />
      <!-- Overlay -->
      <div class="absolute inset-0 bg-black/30"></div>

      <div
        class="relative z-10 max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 text-center py-20"
      >
        <ScrollReveal
          delay={200}
          animation="fade-up"
          intensity="medium"
          client:visible
        >
          <h1
            class="text-5xl md:text-6xl lg:text-7xl font-bold text-white mb-6 leading-tight animate-slide-up"
          >
            Nuestros
            <span class="relative inline-block">
              <span class="text-[#02b6d4]">Servicios</span>
              <svg
                class="absolute -bottom-2 left-0 w-full"
                height="8"
                viewBox="0 0 200 8"
                fill="none"
              >
                <path
                  d="M1 5.5Q50 1 100 5.5T199 5.5"
                  stroke="url(#gradient)"
                  stroke-width="3"
                  stroke-linecap="round"
                  class="animate-draw"></path>
                <defs>
                  <linearGradient
                    id="gradient"
                    x1="0%"
                    y1="0%"
                    x2="100%"
                    y2="0%"
                  >
                    <stop offset="0%" stop-color="#06b6d4"></stop>
                    <stop offset="100%" stop-color="#2563eb"></stop>
                  </linearGradient>
                </defs>
              </svg>
            </span>
          </h1>
        </ScrollReveal>

        <p
          class="text-2xl md:text-2xl text-white max-w-3xl mx-auto leading-relaxed animate-slide-up-delay"
        >
          Soluciones técnicas adaptadas al
          <span class="font-semibold text-white"> territorio altoandino </span>
        </p>
      </div>
    </section>
  </main>

  <!-- Servicios interactivos -->
  <ServiciosSection images={serviciosImages} client:visible />

  <!-- CTA Final - Consulta de Servicios -->
  <section class="py-20 bg-slate-50 relative">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="bg-white rounded-3xl shadow-xl overflow-hidden">
        <!-- Lado derecho - Visual -->
        <div
          class="bg-gradient-to-br from-[#02b6d4] to-[#039bb2] p-4 sm:p-6 md:p-10 lg:p-14 justify-center text-white relative"
        >
          <div class="absolute inset-0 opacity-10">
            <svg
              class="w-full h-full"
              viewBox="0 0 100 100"
              preserveAspectRatio="none"
            >
              <defs>
                <pattern
                  id="grid"
                  width="10"
                  height="10"
                  patternUnits="userSpaceOnUse"
                >
                  <path
                    d="M 10 0 L 0 0 0 10"
                    fill="none"
                    stroke="white"
                    stroke-width="0.5"></path>
                </pattern>
              </defs>
              <rect width="100" height="100" fill="url(#grid)"></rect>
            </svg>
          </div>
          <div class="flex flex-col lg:flex-row justify-between gap-8 lg:gap-4">
            <ScrollReveal
              delay={200}
              animation="fade-left"
              intensity="medium"
              client:visible
            >
              <div class="relative z-10 p-4 sm:p-8 lg:p-12">
                <h3
                  class="text-3xl sm:text-4xl md:text-5xl lg:text-6xl xl:text-7xl font-bold mb-6 leading-tight"
                >
                  Si tienes alguna <span class="block"
                    >pregunta o <span class="block"
                      >consulta, <span class="block">llámanos</span></span
                    >
                  </span>
                </h3>
              </div>
            </ScrollReveal>

            <ScrollReveal
              delay={200}
              animation="fade-right"
              intensity="medium"
              client:visible
            >
              <div class="relative z-10 flex flex-col justify-center lg:mt-16">
                <div
                  class="font-bold text-xl sm:text-2xl md:text-3xl lg:text-4xl mb-8 lg:mb-16 flex flex-row px-4 sm:px-6 lg:px-8 py-3 justify-center items-center rounded-3xl bg-amber-600"
                >
                  <Icon
                    name="phone"
                    class="w-[40px] h-[40px] sm:w-[60px] sm:h-[60px] lg:w-[90px] lg:h-[90px]"
                  />
                  <p class="ml-2 sm:ml-4">+51 915030965</p>
                </div>
                <div
                  class="font-bold text-sm sm:text-lg md:text-xl lg:text-2xl flex flex-col gap-4 lg:gap-8"
                >
                  <div
                    class="flex flex-row bg-amber-600 px-4 sm:px-6 py-3 sm:py-4 rounded-2xl lg:rounded-3xl items-center"
                  >
                    <Icon
                      name="oficina"
                      class="w-[24px] h-[24px] sm:w-[30px] sm:h-[30px] lg:w-[36px] lg:h-[36px] flex-shrink-0"
                    />
                    <p class="ml-2 sm:ml-4">Jr. Los Pinos (almacen central)</p>
                  </div>
                  <div>
                    <div
                      class="flex flex-row bg-amber-600 px-4 sm:px-6 py-3 sm:py-4 rounded-2xl lg:rounded-3xl items-center"
                    >
                      <Icon
                        name="ubicacion"
                        class="w-[24px] h-[24px] sm:w-[30px] sm:h-[30px] lg:w-[36px] lg:h-[36px] flex-shrink-0"
                      />
                      <p class="ml-2 sm:ml-4">Macusani - Carabaya - Puno</p>
                    </div>
                  </div>
                </div>
              </div>
            </ScrollReveal>
          </div>
        </div>
      </div>

      <style>
        @keyframes fade-in {
          from {
            opacity: 0;
          }
          to {
            opacity: 1;
          }
        }

        @keyframes slide-up {
          from {
            opacity: 0;
            transform: translateY(30px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        @keyframes draw {
          from {
            stroke-dashoffset: 200;
          }
          to {
            stroke-dashoffset: 0;
          }
        }

        @keyframes scroll-down {
          0%,
          100% {
            opacity: 1;
            transform: translateY(0);
          }
          50% {
            opacity: 0.5;
            transform: translateY(6px);
          }
        }

        .animate-fade-in {
          animation: fade-in 0.8s ease-out forwards;
        }

        .animate-slide-up {
          animation: slide-up 0.8s ease-out forwards;
        }

        .animate-slide-up-delay {
          animation: slide-up 0.8s ease-out 0.2s forwards;
          opacity: 0;
        }

        .animate-draw {
          stroke-dasharray: 200;
          stroke-dashoffset: 200;
          animation: draw 1.5s ease-out 0.5s forwards;
        }

        .animate-scroll-down {
          animation: scroll-down 1.5s ease-in-out infinite;
        }
      </style>
    </div>
  </section>
</Layout>
